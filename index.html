<!DOCTYPE html>
<html lang="ko">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>자재 관리 시스템</title>
  <script src="https://www.gstatic.com/firebasejs/9.6.1/firebase-app.js"></script>
  <script src="https://www.gstatic.com/firebasejs/9.6.1/firebase-database.js"></script>
  <style>
    body {
      font-family: Arial, sans-serif;
    }
    #material-items {
      margin-top: 20px;
    }
    .material-item {
      margin: 10px 0;
      display: flex;
      align-items: center;
    }
    .material-item p {
      margin: 0 10px 0 0;
    }
    .material-item input {
      margin-right: 10px;
      width: 60px;
    }
  </style>
</head>
<body>
  <h1>자재 현황 관리</h1>
  <div id="material-items"></div>

  <script>
    // Firebase Config
    const firebaseConfig = {
      apiKey: "YOUR_API_KEY",
      authDomain: "YOUR_PROJECT_ID.firebaseapp.com",
      databaseURL: "https://YOUR_PROJECT_ID.firebaseio.com",
      projectId: "YOUR_PROJECT_ID",
      storageBucket: "YOUR_PROJECT_ID.appspot.com",
      messagingSenderId: "YOUR_SENDER_ID",
      appId: "YOUR_APP_ID",
    };

    // Firebase 초기화
    const app = firebase.initializeApp(firebaseConfig);
    const database = firebase.database(app);

    // 자재 데이터를 읽어오는 코드
    const materialRef = database.ref('materials');

    // Firebase에서 자재 데이터 읽기 (실시간으로 업데이트 받기)
    materialRef.on('value', (snapshot) => {
      const materials = snapshot.val();
      console.log(materials);
      renderMaterials(materials); // 자재 목록 렌더링
    });

    // 자재 목록 렌더링 함수
    function renderMaterials(materials) {
      const materialItems = document.getElementById('material-items');
      materialItems.innerHTML = ''; // 기존 자재 리스트 초기화

      // Firebase에서 가져온 자재 목록을 화면에 표시
      for (let key in materials) {
        const material = materials[key];
        const div = document.createElement('div');
        div.classList.add('material-item');
        div.innerHTML = `
          <p>${material.name}</p>
          <input type="number" value="${material.quantity}" data-id="${key}" />
          <button onclick="updateMaterial('${key}')">수정</button>
        `;
        materialItems.appendChild(div);
      }
    }

    // 자재 수정하기
    function updateMaterial(id) {
      const newQuantity = document.querySelector(`input[data-id='${id}']`).value;
      if (newQuantity) {
        // Firebase Realtime Database에서 자재 수량 수정
        materialRef.child(id).update({
          quantity: parseInt(newQuantity),
        }).then(() => {
          alert('수정되었습니다.');
        }).catch((error) => {
          alert('수정에 실패했습니다: ' + error.message);
        });
      } else {
        alert('수량을 입력해주세요.');
      }
    }
  </script>
</body>
</html>
